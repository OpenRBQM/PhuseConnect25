meta:
  Type: mapped
  ID: dm
  Description: Subject Data Mapping 
  Priority: 1
spec: 
  dm:
    SITEID:
      type: character
    USUBJID:
      type: character
    ARM:
      type: character
    RFSTDTC:
      type: character
    RFENDTC:
      type: character
steps:
  # Calculate participant-level time on study and remove participants who failed screening.
  - output: mapped_dm
    name: RunQuery
    params:
      df: dm
      strQuery: |
        SELECT *,
          DATEDIFF(
            'day',
            CAST(RFSTDTC as date),
            CAST(RFENDTC as date)
          ) AS timeonstudy
        FROM df
        WHERE ARM != 'Screen Failure'

