meta:
  Type: Mapped
  ID: STUDY
  Description: Study Metadata 
  Priority: 2
spec:
  Mapped_DM:
    STUDYID:
      type: character
    SUBJID:
      type: character
    timeonstudy:
      type: numeric
steps:
  # Count the number of participants in study.
  - output: ParticipantCounts
    name: RunQuery
    params:
      df: Mapped_DM
      strQuery: |
        SELECT
          STUDYID as GroupID,
          COUNT(DISTINCT SUBJID) as ParticipantCount
        FROM df
        GROUP BY STUDYID

  # Transpose study metadata to one row per attribute.
  - output: Mapped_STUDY
    name: MakeLongMeta
    params:
      data: ParticipantCounts
      strGroupLevel: "Study"

